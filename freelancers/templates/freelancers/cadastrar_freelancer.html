{% extends 'base.html' %}

{% block title %}Cadastrar Freelancer{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card card-custom">
            <div class="card-header bg-primary text-white">
                <h4 class="card-title mb-0">
                    <i class="bi bi-person-plus me-2"></i>Cadastrar Freelancer
                </h4>
            </div>
            <div class="card-body p-4">
                <form method="POST">
                    {% csrf_token %}
                    
                    <div class="row g-4">
                        <!-- Nome Completo -->
                        <div class="col-md-12">
                            <label class="form-label fw-bold">
                                <i class="bi bi-person-vcard me-2"></i>Nome Completo
                            </label>
                            <input type="text" name="nome" class="form-control form-control-lg" required>
                        </div>

                        <!-- CPF -->
                        <div class="col-md-6">
                            <label class="form-label fw-bold">
                                <i class="bi bi-file-earmark-person me-2"></i>CPF
                            </label>
                            <input type="text" name="cpf" class="form-control form-control-lg" required>
                        </div>

                        <!-- Contato -->
                        <div class="col-md-6">
                            <label class="form-label fw-bold">
                                <i class="bi bi-telephone me-2"></i>Contato
                            </label>
                            <input type="text" name="contato" class="form-control form-control-lg" required>
                        </div>

                        <!-- Valor/Hora -->
                        <div class="col-md-6">
                            <label class="form-label fw-bold">
                                <i class="bi bi-currency-dollar me-2"></i>Valor por Hora
                            </label>
                            <div class="input-group input-group-lg">
                                <span class="input-group-text bg-success text-white">R$</span>
                                <input type="number" step="0.01" name="valor_hora" class="form-control" required>
                            </div>
                        </div>

                        <!-- Status -->
                        <div class="col-md-6">
                            <label class="form-label fw-bold">
                                <i class="bi bi-info-circle me-2"></i>Status
                            </label>
                            <select name="status" class="form-select form-select-lg" required>
                                <option value="ativo">Ativo</option>
                                <option value="inativo">Inativo</option>
                                <option value="licenca">Licença</option>
                            </select>
                        </div>

                        <!-- Tipo de Usuário -->
                        <div class="col-md-6">
                            <label class="form-label fw-bold">
                                <i class="bi bi-person-badge me-2"></i>Tipo de Usuário
                            </label>
                            <select name="tipo_usuario" class="form-select form-select-lg" required>
                                <option value="freelancer">Freelancer</option>
                                <option value="admin">Administrador</option>
                            </select>
                            <small class="text-muted mt-1 d-block">
                                <i class="bi bi-info-circle me-1"></i>
                                Administradores têm acesso completo ao sistema
                            </small>
                        </div>

                        <!-- SENHA -->
                        <div class="col-md-6">
                            <label class="form-label fw-bold">
                                <i class="bi bi-key me-2"></i>Senha
                            </label>
                            <input type="password" name="senha" class="form-control form-control-lg" 
                                   placeholder="Digite a senha" required
                                   minlength="6">
                            <small class="text-muted mt-1 d-block">
                                <i class="bi bi-info-circle me-1"></i>
                                A senha deve ter pelo menos 6 caracteres
                            </small>
                        </div>

                        <!-- CONFIRMAR SENHA -->
                        <div class="col-md-6">
                            <label class="form-label fw-bold">
                                <i class="bi bi-key-fill me-2"></i>Confirmar Senha
                            </label>
                            <input type="password" name="confirmar_senha" class="form-control form-control-lg" 
                                   placeholder="Confirme a senha" required
                                   minlength="6">
                            <small class="text-muted mt-1 d-block">
                                <i class="bi bi-info-circle me-1"></i>
                                Digite a mesma senha novamente
                            </small>
                        </div>

                        <!-- Espaço vazio para manter o layout -->
                        <div class="col-md-6">
                            <!-- Espaço reservado para alinhamento -->
                        </div>
                    </div>

                    <!-- VALIDAÇÃO DE SENHA COM JAVASCRIPT -->
                    <script>
                    document.addEventListener('DOMContentLoaded', function() {
                        const form = document.querySelector('form');
                        const senhaInput = document.querySelector('input[name="senha"]');
                        const confirmarSenhaInput = document.querySelector('input[name="confirmar_senha"]');
                        
                        form.addEventListener('submit', function(e) {
                            const senha = senhaInput.value;
                            const confirmarSenha = confirmarSenhaInput.value;
                            
                            if (senha.length < 6) {
                                e.preventDefault();
                                alert('A senha deve ter pelo menos 6 caracteres.');
                                senhaInput.focus();
                                return;
                            }
                            
                            if (senha !== confirmarSenha) {
                                e.preventDefault();
                                alert('As senhas não coincidem. Por favor, digite a mesma senha nos dois campos.');
                                confirmarSenhaInput.focus();
                                return;
                            }
                        });
                    });
                    </script>

                    <!-- Botões -->
                    <div class="row mt-4 pt-3 border-top">
                        <div class="col-md-6">
                            <button type="submit" class="btn btn-primary btn-custom w-100 py-3">
                                <i class="bi bi-check-circle me-2"></i>Cadastrar Freelancer
                            </button>
                        </div>
                        <div class="col-md-6">
                            <a href="{% url 'listar_freelancers' %}" class="btn btn-outline-secondary btn-custom w-100 py-3">
                                <i class="bi bi-x-circle me-2"></i>Cancelar
                            </a>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- CARD INFORMATIVO SOBRE ACESSO -->
        <div class="card card-custom mt-4 bg-light border-info">
            <div class="card-body">
                <h6 class="fw-bold text-info mb-3">
                    <i class="bi bi-info-circle me-2"></i>Informações sobre Acesso
                </h6>
                <div class="row">
                    <div class="col-md-6">
                        <p class="mb-2"><strong>Usuário de acesso:</strong></p>
                        <p class="text-muted">Será gerado automaticamente a partir do CPF</p>
                    </div>
                    <div class="col-md-6">
                        <p class="mb-2"><strong>Senha:</strong></p>
                        <p class="text-muted">Defina uma senha de sua escolha (mínimo 6 caracteres)</p>
                    </div>
                </div>
                <div class="alert alert-warning mt-3 mb-0">
                    <i class="bi bi-exclamation-triangle me-2"></i>
                    <strong>Importante:</strong> O usuário poderá alterar sua senha após o primeiro login.
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}